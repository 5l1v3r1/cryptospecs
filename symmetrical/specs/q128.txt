From: rscott@wwnet.com (Robert Scott)
Newsgroups: sci.crypt
Subject: 128-bit cipher released: Q128 (Long)
Date: Mon, 09 Dec 1996 03:33:55 GMT
Lines: 501
Message-ID: <58g1el$7sc@trellis.wwnet.com>
Reply-To: rscott@wwnet.com
NNTP-Posting-Host: livas425.wwnet.com
X-Newsreader: Forte Free Agent 1.0.82

 Q128:  A block cipher for 128-bit blocks and 128-bit keys. 

This cipher has been designed to efficiently process 128-bit blocks, 
especially on 32-bit processors.  Using the Watcom 32-bit compiler, 
this algorithm was measured to process a 128-bit block in 11 usec. 
on a 75 MHz Pentium.  The same compiler and the same processor 
executes 64-bit Blowfish in 5 usec, which should be doubled to 
account for the smaller block size. 

The algorithm operates on four 32-bit blocks with 16 rounds.  Each 
round propagates 40 of the 128 bits to other blocks, so there is 
complete cascading in four rounds (almost three).  Each round uses 
four 32-bit words of expanded key in the mix.  The complementation 
symmetry of DES is not present.  The basic four word key is expanded 
to 64 words so that every bit in the basic key can affect every bit 
in the expanded key.  The time it takes to expand the basic key is 
approximately the same as the time to encrypt one data block, so key 
setup time is not exceptional. 

The heart of the algorithm is the 1024 x 32-bit fixed random lookup 
table.  The design of this array was carried out using general 
principles of uniform distribution and using Blowfish as a pseudo 
random number generator.  This was done in an effort to present an 
algorithm with no secret design (such as secret S-boxes than might 
be suspected of hiding a back door).  The file FTAB.C that 
accompanies this release is actually the main program that generated 
the table.  Anyone with an correct version of Blowfish should be 
able to run this main program and generate the table used in Q128. 
The comments in the FTAB.C program indicate the design principles 
used.

The follow test vectors were generated by encryption using the all
zeroes key.
                    blk[0]     blk[1]     blk[2]     blk[3]
 Plain Text       0x00000000 0x00000001 0x00000002 0x00000003 
 Encrypted once   0x793465d0 0x1ad543aa 0xdb66960b 0xa0355eb4 
 Encrypted        0x40454f3e 0x7484cdf0 0x76c91989 0x9961da94 
 1,000,000 times

Q128 is hereby released to the public domain.  No permission from me 
is required to use or modify Q128.  Your comments are welcome. 

    -Bob Scott
     rscott@wwnet.com
     8 Dec 1996